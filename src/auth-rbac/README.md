# 权限控制 RBAC

基于角色的权限控制 RBAC（Role Based Access Control）：给用户分配权限的时候，是以角色为单位的，这样如果这个角色的权限变了，那分配这个角色的用户权限也就变了。

需求：管理员的角色有 aaa、bbb 的增删改查权限，而普通用户只有 bbb 的增删改查权限。
有些接口不需要登录也可以访问。

实现：建立用户表、角色表、权限表，用户-角色、角色-权限的中间表，使用 jwt token 存储已登录的用户，通过 handler 上用 SetMetadata 声明该接口是否需要登录、以及需要什么权限，通过 Login Guard 来解析请求 header 中的 token 拿到该用户信息，jwt verify 验证 token 是否合法，合法就继续下一步判断有无该接口的权限，通过从数据库中查出来的当前用户的权限做对比，有相应权限才会放行。可以使用 redis 来缓存用户有哪些权限，避免频繁查数据库。
