# 短链服务

短链服务：把很长的 url 压缩成短的，方便用户分享。一般应用在短信内容，因为短信长度过长阅读体验不好。

实现方案：

1. 用 0、1、2、3、4、5 的递增 id 标识每个 url，把映射关系存到数据库里。不安全
2. 递增 id + base62 作为压缩码，可以保证唯一，但是容易被人拿到其它短码。不安全
3. url 做 hash 之后取一部分然后 base62 做为压缩码，有碰撞的可能。不唯一
4. uid、雪花 id 之类的，那些都太长了，不适合用来做压缩码
5. 随机生成字符串再查表检测是否重复，可以保证唯一且不连续，但是性能不好。用提前批量生成的方式可以解决。✔
🌰: src\short-url

压缩码编码方式：
- base64 就是 26 个大写字母、26 个小写字母、10 个数字、2 个特殊字符，一共 64 个字符。🌰：notes\业务\服务请求\短链服务\demo\src\base64.js
- base62 就是去掉了两个特殊字符，一共 62 个字符。🌰：notes\业务\服务请求\短链服务\demo\src\base62.js
- hash，比如用 crypto 处理成 hash。🌰：notes\业务\服务请求\短链服务\demo\src\crypto-md5-hex.js
- 随机数。🌰：notes\业务\服务请求\短链服务\demo\src\random-str.js

短链跳转：
- 301 永久重定向，就是重定向一次之后，下次浏览器就不会再访问短链，会直接访问长链接。优点是短链服务压力小。
- 302 临时重定向，下次访问短链依然会先访问短链服务，返回 302 后再重定向到长链。优点是 302 每次都会先访问短链服务，这样可以记录链接的访问次数等数据。
